
/*
TSR - SUPPORT
*/ 

;(function(document,$) {


    window.tsrCompare = window.tsrCompare || {};

/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// TSR - Init
/////////////////////////////////////////////////////////////////////////////////////////////////////////


    tsrCompare.tsrInit = function() {
       
         tsrCompare.tsrItemCount();
         tsrCompare.tsrEqualHeights();
         
    };

/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// TSR - Equal heights
/////////////////////////////////////////////////////////////////////////////////////////////////////////

	// Thanks Paul Irish
	$.fn.setAllToMaxHeight = function(){
		return this.height( Math.max.apply(this, $.map( this , function(e){ return $(e).height() }) ) );
	}


/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// TSR - Equal heights
/////////////////////////////////////////////////////////////////////////////////////////////////////////

    tsrCompare.tsrEqualHeights = function () {

	    $('#content-placeholder-compare-data .fixwidth').each(function () {

	        var el = $(this).not('.sticky');

	      	$('h6' , this).css('height', 'auto').setAllToMaxHeight()﻿;
            $('.compare-value' , this).parent().parent().css('height', 'auto').setAllToMaxHeight()﻿;

	    });

    };


/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// TSR - Item count
/////////////////////////////////////////////////////////////////////////////////////////////////////////

    tsrCompare.tsrItemCount = function () {

        $('.ee-product-compare .panel-collapse .row .row').each(function () {

            var el = $(this);
            var elCount =  el.children().length;

            el.children().addClass('ee-count-' + elCount);

        });

    };
  

/////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// Ready
/////////////////////////////////////////////////////////////////////////////////////////////////////////

    $(document).on('ready', function(){

        tsrCompare.tsrInit();
      
    });

/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// Resize
/////////////////////////////////////////////////////////////////////////////////////////////////////////

	// jquery.debouncing.js, thanks Paul Irish

    $(window).smartresize(function(){

  		tsrCompare.tsrEqualHeights();

	});


// compare-page-sticky header
$(window).scroll(function() {
    if ($(this).scrollTop() > 300){
    $('.comparision-header').addClass("sticky");
  }
  else{
    $('.comparision-header').removeClass("sticky");
  }
});

// sticky header with and centered position
    var new_width = $('.panel-default').width();
    var hidden_width = $('.ee-count-5').width()*5;
    if(Modernizr.mq('only screen and (min-width: 768px)')) {
      $('.sticky').width(new_width);
    }
    else {
      $('.sticky').width(hidden_width);
    }

// http://jsfiddle.net/UaGjs/10/
var next;
$('.nexti').click(function() {
    if (next === undefined) {
        next = $('.ee-count-5').next();
    } else {
        if (prev === undefined) {
            next = next.next();
        } else {
            next = prev.next();
                prev = undefined;
        }
    }
    $(".js-datawrapper").scrollTo(next, 800, {
        margin: true
    });
});


var prev;
$('.previ').click(function() {
    if (prev === undefined) {
        if (next === undefined) {
            prev = $('.ee-count-5').prev();
        } else {
            prev = next.prev();
        }

    } else {
        prev = prev.prev();
    }
    $(".js-datawrapper").scrollTo(prev, 800, {
        margin: true
    });
});


/////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////

})(document,jQuery);

/////////////////////////////////////////////////////////////////////////////////////////////////////////
////// END
/////////////////////////////////////////////////////////////////////////////////////////////////////////

